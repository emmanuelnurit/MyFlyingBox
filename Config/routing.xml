<?xml version="1.0" encoding="UTF-8"?>
<routes xmlns="http://symfony.com/schema/routing"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd">

    <!-- Back-office routes -->

    <!-- Main configuration page - this route enables the "Configure" button in modules list -->
    <route id="myflyingbox.admin.config" path="/admin/module/MyFlyingBox" methods="GET">
        <default key="_controller">MyFlyingBox\Controller\ConfigurationController::indexAction</default>
    </route>

    <route id="myflyingbox.admin.config.save" path="/admin/module/myflyingbox/config" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ConfigurationController::saveAction</default>
    </route>

    <route id="myflyingbox.admin.test.api" path="/admin/module/myflyingbox/test-api" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ConfigurationController::testApiAction</default>
    </route>

    <route id="myflyingbox.admin.refresh.services" path="/admin/module/myflyingbox/refresh-services" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ConfigurationController::refreshServicesAction</default>
    </route>

    <route id="myflyingbox.admin.service.toggle" path="/admin/module/myflyingbox/service/toggle" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ConfigurationController::toggleServiceAction</default>
    </route>

    <route id="myflyingbox.admin.service.delay" path="/admin/module/myflyingbox/service/delay" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ConfigurationController::updateServiceDelayAction</default>
    </route>

    <route id="myflyingbox.admin.dimension.save" path="/admin/module/myflyingbox/dimension/save" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ConfigurationController::saveDimensionAction</default>
    </route>

    <route id="myflyingbox.admin.dimension.delete" path="/admin/module/myflyingbox/dimension/delete" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ConfigurationController::deleteDimensionAction</default>
    </route>

    <route id="myflyingbox.admin.diagnostic" path="/admin/module/myflyingbox/diagnostic" methods="GET">
        <default key="_controller">MyFlyingBox\Controller\ConfigurationController::diagnosticAction</default>
    </route>

    <!-- Shipment management routes -->
    <!-- IMPORTANT: Specific routes MUST be declared BEFORE the generic {shipmentId} route -->

    <route id="myflyingbox.admin.shipment.book" path="/admin/module/myflyingbox/shipment/book" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ShipmentController::bookAction</default>
    </route>

    <route id="myflyingbox.admin.shipment.labels" path="/admin/module/myflyingbox/shipment/labels" methods="GET">
        <default key="_controller">MyFlyingBox\Controller\ShipmentController::labelsAction</default>
    </route>

    <route id="myflyingbox.admin.shipment.status" path="/admin/module/myflyingbox/shipment/status" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ShipmentController::updateStatusAction</default>
    </route>

    <route id="myflyingbox.admin.shipment.cancel" path="/admin/module/myflyingbox/shipment/cancel" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ShipmentController::cancelAction</default>
    </route>

    <route id="myflyingbox.admin.shipment.create" path="/admin/module/myflyingbox/shipment/create" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ShipmentController::createAction</default>
    </route>

    <route id="myflyingbox.admin.shipment.create-return" path="/admin/module/myflyingbox/shipment/create-return" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ShipmentController::createReturnAction</default>
    </route>

    <route id="myflyingbox.admin.shipment.sync-tracking" path="/admin/module/myflyingbox/shipment/sync-tracking" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\ShipmentController::syncTrackingAction</default>
    </route>

    <route id="myflyingbox.admin.shipment.tracking" path="/admin/module/myflyingbox/shipment/tracking" methods="GET">
        <default key="_controller">MyFlyingBox\Controller\ShipmentController::trackingAction</default>
    </route>

    <route id="myflyingbox.admin.shipment.debug-tracking" path="/admin/module/myflyingbox/shipment/debug-tracking" methods="GET">
        <default key="_controller">MyFlyingBox\Controller\ShipmentController::debugTrackingAction</default>
    </route>

    <!-- Generic shipment view route - MUST be LAST to avoid capturing specific paths -->
    <route id="myflyingbox.admin.shipment.view" path="/admin/module/myflyingbox/shipment/{shipmentId}" methods="GET">
        <default key="_controller">MyFlyingBox\Controller\ShipmentController::viewAction</default>
        <requirement key="shipmentId">\d+</requirement>
    </route>

    <!-- Tracking routes -->
    <route id="myflyingbox.admin.tracking.get" path="/admin/module/myflyingbox/tracking" methods="GET">
        <default key="_controller">MyFlyingBox\Controller\TrackingController::getTrackingAction</default>
    </route>

    <route id="myflyingbox.admin.tracking.sync" path="/admin/module/myflyingbox/tracking/sync" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\TrackingController::syncStatusAction</default>
    </route>

    <!-- Front-office routes -->
    <route id="myflyingbox.front.relay.points" path="/myflyingbox/relay-points" methods="GET">
        <default key="_controller">MyFlyingBox\Controller\Front\RelayController::getRelayPointsAction</default>
    </route>

    <route id="myflyingbox.front.relay.save" path="/myflyingbox/relay/save" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\Front\RelayController::saveRelayAction</default>
    </route>

    <route id="myflyingbox.front.offer.save" path="/myflyingbox/offer/save" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\Front\RelayController::saveOfferAction</default>
    </route>

    <route id="myflyingbox.front.offers.get" path="/myflyingbox/offers" methods="GET">
        <default key="_controller">MyFlyingBox\Controller\Front\RelayController::getOffersAction</default>
    </route>

    <!-- Webhook routes (external, no Thelia authentication required) -->
    <route id="myflyingbox.webhook.tracking" path="/myflyingbox/webhook/tracking" methods="POST">
        <default key="_controller">MyFlyingBox\Controller\WebhookController::trackingAction</default>
    </route>

</routes>
